<script type="text/javascript">
  var monthsWorkHoursTemp = {{monthsWorkHours | safe}}

  function renderWorkHourChart(addHours){
    var WH_BG_Colors = []
    var WH_B_Colors = []
    var today = new Date();
    var dd = String(today.getDate()).padStart(2, '0');
    if (addHours){
      if (monthsWorkHoursTemp[dd-1] != "nan"){
        monthsWorkHoursTemp[dd-1] = parseFloat(monthsWorkHoursTemp[dd-1]) + parseFloat(addHours);
      }else{
        monthsWorkHoursTemp[dd-1] = parseFloat(addHours);
      }
    }

    monthsWorkHoursTemp.forEach((item, i) => {
      if(parseInt(item)<4){
        WH_BG_Colors.push('rgba(252,146,114, 1)')
        WH_B_Colors.push('rgba(203,24,29, 1)')
      }else if(parseInt(item)<6){
        WH_BG_Colors.push('rgba(254,196,79, 1)')
        WH_B_Colors.push('rgba(236,112,20, 1)')
      }else if(parseInt(item)>8){
        WH_BG_Colors.push('rgba(128,205,193, 1)')
        WH_B_Colors.push('rgba(53,151,143, 1)')
      }else{
       WH_BG_Colors.push('rgba(107,174,214, 1)')
       WH_B_Colors.push('rgba(33,113,181, 1)')
      }

    });



    var ctx = document.getElementById("WHTracker").getContext('2d');
    var WHBarChart = new Chart(ctx, {
       type: 'bar',
       data: {
          labels: {{ChartMonthDays|safe}},
          datasets: [{
             label: "Working Hours (hr)",
             data: monthsWorkHoursTemp,
             backgroundColor: WH_BG_Colors,
             borderColor: WH_B_Colors,
             borderWidth: 2,
          }
        ]
       },
       options: { scales: { yAxes: [{ticks:{suggestedMax: 10, beginAtZero: true }}]}}
    });
  }

  function submitWHours(){
    var worHours = document.getElementById("workHourVal").value;
    $.ajax({
        type: "POST",
        url: "http://localhost:5000/home",
        data: {"tracker_type":"WorkHours", "value": worHours},
    });
    document.getElementById("workHourVal").value = "";
    renderWorkHourChart(worHours)
  }

</script>

<div style="width:45%;min-height:220px;background-color:white;margin-bottom: 20px; margin-left:3.3%;border-radius:10px;text-align:center;float:left;">
  <div style="margin-top: 10px; margin-right: 20px; width: 220px; float:right" >
    Add Work Hours: <input type="text" id="workHourVal" name="date" style="width: 50px; ">
    <i class="fa fa-check" id="submitToGraph" onclick="submitWHours()"></i>
  </div>
  <i class="fa fa-wrench" style="float:left; margin-left:10px; margin-top:10px;"></i>
  <h2  class="title lightbg"  style="float:left; margin-left: 10px;">Work Hours Tracker</h2>
  <div style="float:left; width:90%; margin-left:5%">
    <canvas  height="100px" id="WHTracker"></canvas>
  </div>
</div>
